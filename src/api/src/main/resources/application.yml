server:
  port: 8080

spring:
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://${SECP_DB_HOST:localhost}:${SECP_DB_PORT:5432}/${SECP_DB_DB:secp}}
    username: ${SPRING_DATASOURCE_USERNAME:${SECP_DB_USER:postgres}}
    password: ${SPRING_DATASOURCE_PASSWORD:${SECP_DB_PASS:postgres}}
    hikari:
      maximum-pool-size: 10
  flyway:
    enabled: ${SPRING_FLYWAY_ENABLED:true}
    url: ${SPRING_FLYWAY_URL:}
    user: ${SPRING_FLYWAY_USER:}
    password: ${SPRING_FLYWAY_PASSWORD:}
  data:
    redis:
      host: ${SPRING_DATA_REDIS_HOST:${SECP_REDIS_HOST:localhost}}
      port: ${SPRING_DATA_REDIS_PORT:${SECP_REDIS_PORT:6379}}

secp:
  storage:
    mode: ${SECP_STORAGE_MODE:minio}
  jwt:
    issuer: secp-api
    secret: ${SECP_JWT_SECRET:dev-secret-change-me}
    ttl-seconds: 86400
  auth:
    group-cache-ttl-seconds: 45
  idempotency:
    ttl-seconds: 86400
    in-progress-ttl-seconds: 120
  sms:
    code-ttl-seconds: 300
    send-cooldown-seconds: 60
    daily-max-per-phone: 10

  s3:
    # In tests these are overridden by Testcontainers (MinIO)
    endpoint: ${SECP_S3_ENDPOINT:}
    region: ${SECP_S3_REGION:us-east-1}
    bucket: ${SECP_S3_BUCKET:secp-dev}
    access-key: ${SECP_S3_ACCESS_KEY:}
    secret-key: ${SECP_S3_SECRET_KEY:}
    path-style: ${SECP_S3_PATH_STYLE:true}

  preview:
    max-size-bytes: 52428800 # 50MB
    max-pages: 80
    cache-ttl-seconds: 86400
    watermark:
      wm-ver: 1
      time-format: "yyyy-MM-dd HH:mm:ss"
      density-multiplier: 1.0
      external:
        angle: -35
        opacity: 0.18
        font-size: 22
        template: "{tag} | {username} | {phone_last4} | {timestamp}"
      client:
        angle: -35
        opacity: 0.12
        font-size: 18
        template: "CLIENT | {username} | {timestamp}"
      internal:
        angle: -35
        opacity: 0.08
        font-size: 16
        template: "INTERNAL | {username} | {timestamp}"

logging:
  level:
    root: INFO
